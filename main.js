
var items = {
    name: "Earth",
    title: "Geologic Time Periods",
    body: {req: "Geological history of Earth"},
    color: "#98cfbc",
    children: [
        {
            name: "Hadean",
            color: "#cabf72",
            },
        {
            name: "Archean",
            color: "#faca85",
            children: [
                {name:"Eoarchean", color:"#b6a6a0"},
                {name:"Paleoarchean", color:"#a9a693"},
                {name:"Mesoarchean", color:"#7d8991"},
                {name: "Neoarchean", color:"#607363"}]
            },
        {
            name: "Proterozoic",
            color: "#84b791",
            children: [
                {
                    name: "Paleoproterozoic",
                    color: "#a6e2c2",
                    children: [
                        {
                            name: "Siderian",
                            color: "",
                            },
                        {
                            name: "Rhyacian",
                            color: "",
                            },
                        {
                            name: "Orosirian",
                            color: "",
                            },
                        {
                            name: "Statherian",
                            color: "",
                            },
                    ]
                    },
                {
                    name: "Mesoproterozoic",
                    color: "",
                    children: [
                        {
                            name: "Calymmian",
                            color: "",
                            children: [],
                            },
                        {
                            name: "Ectasian",
                            color: "",
                            children: [],
                            },
                        {
                            name: "Stenian",
                            color: "",
                            children: [],
                            },
                    ]
                    },
                {
                    name: "Neoproterozoic",
                    color: "",
                    children: [
                        {
                            name: "Tonian",
                            color: "",
                            children: [],
                            },
                        {
                            name: "Cryogenian",
                            color: "",
                            children: [],
                            },
                        {
                            name: "Ediacaran",
                            color: "",
                            children: [],
                            },
                    ]
                    },
            ]
            },
        {
            name: "Phanerozoic",
            color: "#9dc46b",
            children: [
                {
                    name: "Paleozoic",
                    color: "#81a2d9",
                    children: [
                        {
                            name: "Cambrian",
                            body: "The Cambrian spans from 540 million years to 485 million years ago and is the first period of the Paleozoic and of the Phanerozoic Eon. The Cambrian sparks a boom in evolution in an event known as the Cambrian Explosion in which the largest number of creatures evolve in the history of Earth during one period. Creatures like algae evolve, but most of the water is populated by armored arthropods, like trilobites. Almost all marine phyla evolved in this period. During this time, the super-continent Rodinia begins to break up, most of which becomes the super-continent Gondwana",
                            color: "#c86f97",
                            children: [],
                            },
                        {
                            name: "Ordovician",
                            body: "The Ordovician spans from 485 million years to 440 million years ago. The Ordovician is a time in earths history in which many species still prevalent today evolved, such as primitive fish, cephalopods, and coral. The most common forms of life, however, were trilobites, snails and shellfish. More importantly, the first arthropods went ashore to colonize the empty continent of Gondwana. By the end of the period, Gondwana was at the south pole, early North America had collided with Europe, closing the Atlantic Ocean. Glaciation of Africa resulted in a major drop in sea level, killing off all life that staked a claim along coastal Gondwana. Glaciation caused a snowball earth, and the Ordovician-Silurian extinction in which 60% of marine invertebrates and 25% of families went extinct, and is considered the first mass extinction and the second deadliest extinction.",
                            color: "#9b6fc8",
                            children: [],
                            },
                        {
                            name: "Silurian",
                            body: {req:"Silurian"},
                            color: "#828ee5",
                            children: [],
                            },
                        {
                            name: "Devonian",
                            body: "The Devonian spans from 415 million years to 360 million years ago. Also known as 'The Age of the Fish', the Devonian features a huge diversification of fish, including armored fish like Dunkleosteus and lobe-finned fish which eventually evolved into the first tetrapods. On land, plant groups diversified incredibly in an event known as the Devonian Explosion where the first trees evolved, as well as seeds. This event also diversified arthropod life. The first amphibians also evolved, and the fish were now at the top of the food chain. Near the end of the Devonian, 70% of all species went extinct in an event known as the Late Devonian extinction and is the second mass extinction event the world has seen.",
                            color: "#5b8dc1",
                            children: [],
                            },
                        {
                            name: "Carboniferous",
                            body: "The Carboniferous spans from 360 million to 300 million years ago. During this time, average global temperatures were exceedingly high; the early Carboniferous averaged at about 20 degrees Celsius (but cooled down to 10 degrees during the Middle Carboniferous).[7] Tropical swamps dominated the earth, and the large amounts of trees created much of the carbon for the coal that is used today (hence the name 'Carbon-iferous'). Perhaps the most important evolutionary development of the time was the evolution of amniotic eggs, which allowed amphibians to head farther inland and remain the dominant vertebrate throughout the duration of this period. Also, the first reptiles and synapsids evolved in the swamps. Throughout the Carboniferous, there was a cooling pattern, which eventually led to the glaciation of Gondwana as much of it was situated around the south pole in an event known as the Permo-Carboniferous glaciation or the Carboniferous Rainforest Collapse.",
                            color: "#f4bc5b",
                            children: [],
                            },
                        {
                            name: "Permian",
                            body: "The Permian spans from 300 million to 250 million years ago and was the last period of the Paleozoic. At the beginning, all continents formed together to form the super-continent Pangaea and had one ocean called Panthalassa. The earth was very dry during this time, with harsh seasons as the climate of the interior of Pangaea wasn't regulated by large bodies of water. Reptiles and synapsids flourished in the new dry climate. Creatures such as Dimetrodon and Edaphosaurus ruled the new continent. The first conifers evolve, and dominate the terrestrial landscape. Nearing the end of the Permian, however, Pangaea got drier and drier. The interior was nothing but dry deserts, and new species such as Scutosaurus and Gorgonopsid filled the empty desert. Eventually, they disappeared, along with 95% of all life on earth in an event simply known as 'the Great Dying', and is the third mass extinction event of the world.",
                            color: "#d9d67c",
                            children: [],
                            },
                    ],
                    },
                {
                    name: "Mesozoic",
                    color: "#71dc88",
                    children: [
                        {
                            name: "Triassic",
                            title: "Triassic Period",
                            body: {req: "Triassic"},
                            color: "#aebdb0",
                            children: [
                                {name:"Early Triassic",
                                    color: "#aebdb0",
                                    children:[{name:"Induan"},{name:"Olenekian"}]},
                                {name:"Middle Triassic",
                                    color: "#93bb96",
                                    children:[{name:"Anisian"},{name:"Ladinian"}]},
                                {name:"Late Triassic",
                                    color: "#77ba7d",
                                    children:[{name:"Carnian"},{name:"Norian"},{name:"Rhaetian"}]},
                            ]},
                        {
                            name: "Jurassic",
                            color: "#7cb35e",
                            children: [
                                {name:"Early Jurassic",
                                    color: "#5eb36e",
                                    children:[{name:"Hettangian"},{name:"Sinemurian"},{name:"Pliensbachian"},{name:"Toarcian"}]},
                                {name:"Middle Jurassic",
                                    color: "#7cb35e",
                                    children:[{name:"Aalenian"},{name:"Bajocian"},{name:"Bathonian"},{name:"Callovian"}]},
                                {name:"Late Jurassic",
                                    color: "#9ab35e",
                                    children:[{name:"Oxfordian"},{name:"Kimmeridgian"},{name:"Tithonian"}]},
                            ],},
                        {
                            name: "Cretaceous",
                            color: "#d9df7d",
                            children: [
                                {name:"Early Cretaceous",
                                    color: "#dfd77d",
                                    children:[{name:"Berriasian"},{name:"Valanginian"},{name:"Hauterivian"},{name:"Barremian"},{name:"Aptian"},{name:"Albian"}]},
                                {name:"Late Cretaceous",
                                    color: "#dfb47d",
                                    children:[{name:"Cenomanian"},{name:"Turonian"},{name:"Coniacian"},{name:"Santonian"},{name:"Campanian"},{name:"Maastrichtian"}]},
                            ],},
                    ]
                     },
                {
                    name: "Cenozoic",
                    title: "Cenozoic Era",
                    body: {req: "Cenozoic"},
                    color: "#e07b78",
                    children: [
                        {
                            name: "Paleogene",
                            color: "#f4b96c",
                            children: [
                                {name:"Paleocene",
                                    color: "#cf5151",
                                    children:[{name:"Danian"},{name:"Selandian"},{name:"Thanetian"},{name:"Ypresian"},{name:"Lutetian"},{name:"Albian"}]},
                                {name:"Eocene",
                                    color: "#febfdd",
                                    children:[{name:"Ypresian"},{name:"Lutetian"},{name:"Bartonian"},{name:"Priabonian"}]},
                                {name:"Oligocene",
                                    color: "#c360b6",
                                    children:[{name:"Rupelian"},{name:"Chattian"}]},
                            ],},
                        {
                            name: "Neogene",
                            color: "#f47c6c",
                            children: [
                                {name:"Miocene",
                                    color: "#a67be6",
                                    children:[{name:"Aquitanian"},{name:"Burdigalian"},{name:"Langhian"},{name:"Serravallian"},{name:"Tortonian"},{name:"Messinian"}]},
                                {name:"Pliocene",
                                    color: "#a5affd",
                                    children:[{name:"Zanclean"},{name:"Piacenzian"}]},
                            ],},
                        {
                            name: "Quaternary",
                            color: "#db779b",
                            children: [
                                {
                                    name: "Pleistocene",
                                    color: "#9fd5ff",
                                    children: [
                                        {name:"Gelasian"},{name:"Calabrian",body:{req:"Calabrian (stage)"}},
                                        {name:"Ionian",body:{req:"Middle Pleistocene"}},{name:"Tarantian",body:{req:"Late Pleistocene"}}],
                                    },
                                {
                                    name: "Holocene",
                                    color: "#ffd9a7",
                                    children: [
                                        {
                                            name: "Preboreal",
                                            title: "Preboreal Chronozones",
                                            color: "#76d980",
                                            children: [],
                                            },
                                        {
                                            name: "Boreal",
                                            title: "Boreal Chronozones",
                                            body: {req: "Boreal (age)"},
                                            color: "#68b15e",
                                            children: [],
                                            },
                                        {
                                            name: "Atlantic",
                                            title: "Atlantic Chronozones",
                                            body: {req: "Atlantic (preiod)"},
                                            color: "#64cdc2",
                                            children: [],
                                            },
                                        {
                                            name: "Subboreal",
                                            title: "Subboreal Chronozones",
                                            color: "#64cd9f",
                                            children: [],
                                            },
                                        {
                                            name: "Subatlantic",
                                            title: "Subatlantic Chronozones",
                                            color: "#75efe5",
                                            children: [
                                                {
                                                    name: "Older",
                                                    title: "Older Subatlantic",
                                                    body: "500BC - 500AD",
                                                    color: "#6e788a",
                                                    children: [],
                                                    },
                                                {
                                                    name: "Middle",
                                                    title: "Middle Subatlantic",
                                                    body: "500 - 1250",
                                                    color: "#8c98af",
                                                    children: [],
                                                    },
                                                {
                                                    name: "Younger",
                                                    title: "Younger Subatlantic",
                                                    body: "1250 - 1800",
                                                    color: "#adbcd8",
                                                    children: [],
                                                    },
                                                {
                                                    name: "Youngest",
                                                    title: "Youngest Subatlantic",
                                                    body: "1800 - present",
                                                    color: "#c7dafd     ",
                                                    children: [],
                                                    },
                                            ],
                                            },
                                        
                                    ],
                                    },
                            ],
                            },
                    ],
                    },
            ]
            },
    ]
}

var titles = ["XX", "YY", "Eon", "Era", "Period", "Epoch", "Age", "Chronozone"];

function walk(obj, depth){
    if(depth > 33)return {};
    if(!obj.title){
        obj.title = obj.name + " " + titles[depth];
    }
    if(!obj.body){
        obj.body = {req: obj.name};
    }
    var fin = function(){
        return obj
    };
    if(obj.children){
        for(var i = 0; i < obj.children.length; i++){
            fin[obj.children[i].name] = walk(obj.children[i], depth?depth+1:1)
        }
    }
    return fin
}

var tree = walk({body: "", name: items.name, children: [items]});
function clr(color, backup){
    return " style='background-color:"+(color?color:backup)+";' "
}
function render(index){
    var html = "";
    var obj = tree;
    var color = "white";
    try{
        for(var i = 0; i < index.length; i++){
            item = obj[index[i]]();
            if(item.color)color = item.color;
            html += "<div class='title'"+clr(color)+"><a href='#"+
                    index.slice(1, i+1).join("#")+
                    "'><h1 "+(i===0?"class='first'":"")+">" + item.title + "</h1></a></div>";
            if(i === index.length-1){
                if(item.body.req){
                    var req = {};
                    req[item.body.req] = item;
                    fulfill(req);
                    var text = "Loading";
                }else var text = item.body
                html += "<div class='body'"+clr(color)+">"+text+"</div>";
            }
            if(item.children){
                html += "<div class='choices'>"
                for(var c = 0; c < item.children.length; c++){
                    html += "<div"+clr(item.children[c].color, color)+"><a href='#"+
                        index.slice(1, i+1).concat(item.children[c].name).join("#")+
                        "'>"+item.children[c].name+
                        "</a></div>";
                }
                html += "</div>"
            }
            obj = obj[index[i]];
        }
    }catch(e){
        console.log(e);
    }
    document.body.innerHTML = html;
}
function rerender(){
    render($.extend(location.hash.split("#"), [items.name]));
}
$(window).on("hashchange", rerender)
rerender();